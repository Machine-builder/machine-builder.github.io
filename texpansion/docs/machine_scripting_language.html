<!--IGNORECOMPILE-->
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css" integrity="sha256-XoaMnoYC5TH6/+ihMEnospgm0J1PM/nioxbOUdnM8HY=" crossorigin="anonymous">

    
<link rel="stylesheet" href="../styles/callout.css">
<link rel="stylesheet" href="../styles/codeblock.css">
<link rel="stylesheet" href="../styles/list.css">
<link rel="stylesheet" href="../styles/headings.css">
<link rel="stylesheet" href="../styles/table_of_contents.css">


    <title>Scripting Machines: MSL</title>
  </head>
  <body>
    <br>
    <br>
    <br>
    <div class="container">
        <h1>Scripting Machines: MSL</h1>
        <hr/>
        
        <div id="table-of-contents">
        </div>
        <hr/>
        
        

<h1>Machine Scripting Language (MSL)</h1>
<p>
    Machine Scripting Language, or MSL for
    short is Texpansion's way of allowing
    players to write programs for their
    devices. MSL is comprised of instructions
    - One per line. See concepts below and
    which instruction corresponds to which
    action.</p>

<h1>Concepts</h1>

<h2>Expressions</h2>
<p>
    Read on further, and when you come
    across an expression in curly
    parenthesis <code>{}</code>, refer here for
    information.</p>

<h3><code>{EXPRESSION}</code></h3>
<p>Any kind of value or mathematical or logical expression.</p>
<ul class="callout"><li>
    Booleans are represented as a 1 or 0. Remember, there is no dedicated boolean type!
</li></ul>
<ul class="callout callout-warn"><li>
    Expressions can be nested, but note that there is <b>no order of operations</b>.
    So while <code>$VAR1 + $VAR2 * $VAR3</code> is a valid expression, the result
    will be <code>($VAR1 + $VAR2) * $VAR3</code>
</li></ul>
<ul>
    <li> <code>"String"</code> Any text surrounded by quotations is a string. </li>
    <li> <code>928.5</code> Any text comprised of only digits or a period is a number. </li>
    <li> <code>$VAR</code> Any text starting with <code>$</code> is a variable reference. </li>
    <li> <code>{EXPRESSION} {OPERATOR} {EXPRESSION}</code> The basis of all MSL mathematical calculations.
        One expression, one conjunction (operator), and a second expression. </li>
</ul>

<h3><code>{OPERATOR}</code></h3>
<p>A conjunction used in a mathematical expression.</p>
<div class="row align-items-start">
    <div class="col">
        <ul>
            <li> <code>+</code> Addition.</li>
            <li> <code>-</code> Subtraction.</li>
            <li> <code>*</code> Multiplication.</li>
            <li> <code>/</code> Division.</li>
            <li> <code>&&</code> Logical AND.</li>
            <li> <code>|</code> Logical OR.</li>
            <li> <code>!</code> Logical NOT.</li>
        </ul>
    </div>
    <div class="col">
        <ul>
            <li> <code>></code> Greater than.</li>
            <li> <code>>=</code> Greater than or equal to.</li>
            <li> <code><</code> Less than.</li>
            <li> <code><=</code> Less than or equal to.</li>
            <li> <code>=</code> Equality.</li>
            <li> <code>!=</code> Inequality.</li>
        </ul>
    </div>
</div>

<h3><code>{ITEM}</code></h3>
<p>An item selector - Can be used to filter items</p>
<ul>
    <li> <code>ALL</code> All items (no filter).</li>
    <li> <code>+typeId,typeId,...</code> Whitelist (only items that match listed typeId(s)).</li>
    <li> <code>-typeId,typeId,...</code> Blacklist (only items that do not match listed typeId(s)).</li>
</ul>

<h2>Instructions</h2>
<p>
    Instructions allow machines to actually <i>do things</i>.
    This includes things like - collecting items, flying to some location,
    or interacting with some block.<br>
    While the documentation below may look daunting, if you break
    it up piece-by-piece it's actually quite manageable. In fact, before we get down there,
    take a look at these examples and see if you can understand them:<br>
    <b>Flying to a port and collecting all the cobblestone</b><br>
    <code style="display:block; white-space:pre-wrap">GOTO PORT "cobblePort"
CONTAINER TRANSFER SELF +cobblestone</code>
    <b>Returning home and depositing all items</b><br>
    <code style="display:block; white-space:pre-wrap">GOTO PORT "home"
CONTAINER TRANSFER OTHER ALL</code>
    See? Not so hard! Take a look through each instruction for formatting instructions and
    a brief description of how it's used.
</p>

<h3><code>CONTAINER</code> - Accessing Storage Containers</h2>
<p>
    Sometimes machines need to access storage containers,
    like drones. The <code>CONTAINER</code> instruction is what you'll
    need to use. An example instruction that takes all
    cobblestone from a container would be written as:
    <code>CONTAINER TRANSFER OTHER +COBBLESTONE.</code></p>
<ul>
    <li><code>CONTAINER [TRANSFER|DROP|COUNT]</code></li>
    <ul>
        <li><code>TRANSFER (toContainer)[SELF|OTHER] {ITEM}</code>
            Transfer items from one container to <code>toContainer</code>.</li>
        <li><code>DROP {ITEM}</code>
            Drops item(s) onto the ground.</li>
        <li><code>COUNT $VAR (container)[SELF|OTHER] {ITEM}</code>
            Count how many items match the filter from <code>container</code>,and store the result in the variable <code>$VAR</code>.</li>
    </ul>
</ul>

<h3><code>GOTO</code> - Making Drones Fly</h2>
<p>
    This instruction allows drones to fly to some given location or port.</p>
<ul>
    <li><code>GOTO [PORT|LOCATION]</code></li>
    <ul>
        <li><code>PORT (portName){EXPRESSION}</code>
            Fly to a port by name. <code>portName</code> must be a string.</li>
        <li><code>LOCATION (xyz){EXPRESSION}</code>
            Fly to a block location. <code>xyz</code> must be a string in the form
            <code>X,Y,Z</code> where <code>X</code>, <code>Y</code>, <code>Z</code> are integers.</li>
    </ul>
</ul>

<h3><code>WAIT</code> - Adding Timed Delays</h2>
<p>
    The <code>WAIT</code> instruction allows machines to wait for
    some amount of time before continuing their sequence.</p>
<ul>
    <li><code>WAIT (time){EXPRESSION}</code> Wait for some given amount of time (in seconds). <code>time</code> must be a number.</li>
</ul>

<h3><code>VAR</code> - Defining Variables</h2>
<p>
    Variables are typically used for controlling logical flow via conditions, but can also be used to perform other calculations such as math.</p>
<ul>
    <li><code>VAR (variable)$VAR (value){EXPRESSION}</code> Set <code>variable</code> to <code>value</code>.</li>
</ul>

<h3><code>MARKER</code> - Logical Flow</h2>
<p>
    Markers are used to define logical flow. If you want the machine to
    go to some instruction, define a marker on the line before that instruction
    using <code>MARKER DEF "someMarkerName"</code>,
    and then use <code>MARKER JUMP "someMarkerName"</code>.</p>
<ul>
    <li><code>MARKER [DEF|JUMP|JUMPIF]</code></li>
    <ul>
        <li><code>DEF [STATIC|DYNAMIC] (markerName){EXPRESSION}</code>
            Define a marker at the code line. If type is <code>STATIC</code>,
            then <code>markerName</code> must be a static string, ie. <code>MARKER DEF STATIC "someMarkerName"</code>.
            If type is <code>DYNAMIC</code>, then the name can be specified on the fly, using a variable for
            instance, like so: <code>MARKER DEF DYNAMIC $MARKERNAME</code>.
        </li>
        <li><code>JUMP (markerName){EXPRESSION}</code>
            Jump the current code line to the marker <code>markerName</code>.
        </li>
        <li><code>JUMPIF (markerName){EXPRESSION} (condition){EXPRESSION}</code>
            Jump the current code line to the marker <code>markerName</code>, only if <code>condition</code> is met.
        </li>
    </ul>
</ul>


    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    
    <!--IGNORECOMPILE-->
<script type="text/javascript">
    function reloadTableOfContents() {
    console.log("Reloading table of contents");
    const headers = $("h1, h2, h3, h4");
    let element = document.createElement("ul");
    for (let header of headers) {
        let tagName = header.tagName;
        let headerDepth = tagName=="H1" ? 0: tagName=="H2" ? 1: tagName=="H3" ? 2: 3;
        let child = document.createElement("li");
        child.style.paddingLeft = `${headerDepth*16+10}px`;
        child.innerText = header.innerText;
        child.onclick = function() {
        header.scrollIntoView(true);
        }
        element.appendChild(child);
    }
    document.getElementById("table-of-contents").appendChild(element);
    };
    reloadTableOfContents();
</script>
    
  </body>
</html>